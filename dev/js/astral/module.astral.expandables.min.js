import*as AU from"./module.AstralUtilities.min.js";window.AstralExpandables=function(e,t){var a=function(e,t){var a,n,s=!1,l=!1,i=!1,o="",r={accordion:!1,ajaxCallback:!1,ajaxCustomHandling:!1,ajaxType:"html",bookmarkable:!1,callbackOpened:!1,callbackClosed:!1,content:".content",cssTransitionSpeed:200,dropdown:!1,enableARIA:!0,event:"click",expandable:".expandable",openClass:"open",remember:!0,tooltipClosed:"click to view more",tooltipOpened:"click to hide details",trigger:".trigger"};function d(e){var t=!!a.dropdown,n=e.querySelector(a.content),s=(getComputedStyle(n),t?n:e);e.dataset.animating=!0,t?n.style.height=0:e.style.height=e.dataset.closedHeight,e.classList.add(a.openClass),requestAnimationFrame(function(){t?n.style.height=parseInt(e.dataset.openedHeight)-parseInt(e.dataset.closedHeight)+"px":e.style.height=e.dataset.openedHeight}),setTimeout(function(){e.dataset.animating=!1,e.querySelector(a.trigger).setAttribute("title",a.tooltipOpened)},a.cssTransitionSpeed)}function c(e){var t=e.querySelector(a.content),n=getComputedStyle(t),s=getComputedStyle(e);t.style.width=s.width,AU.setData(e,{closedHeight:s.height,openedHeight:parseInt(s.height)+parseInt(t.offsetHeight)+"px"}),t.removeAttribute("style"),e.classList.contains(a.openClass)&&AU.setData(e,{closedHeight:parseInt(s.height)-parseInt(n.marginTop)-parseInt(t.scrollHeight)+"px",openedHeight:parseInt(s.height)+"px"})}return function(e,t){if(n=e,a=r,t&&"object"==typeof t&&(a={...a,...t}),n.dataset.options){var p=AU.parseDataOptions(n.dataset.options);a={...a,...p}}!function(){var e,t=n.querySelectorAll(a.trigger),r=n.querySelectorAll("."+a.openClass);if(AU.delegate(n,a.event,a.trigger,function(e){var t,s,r=this.closest(a.expandable);if(r.querySelector(a.content),"true"==r.dataset.animating)return!1;c(r,a.openClass),r.classList.contains(a.openClass)||!a.accordion||l||(l=!0,n.querySelectorAll(a.trigger).forEach(e=>{e.parentElement.classList.contains(a.openClass)&&e.dispatchEvent(new Event(a.event,{bubbles:!0}))}),l=!1),t=this,(s=r).classList.contains(a.openClass)?(function(e){var t=!!a.dropdown,n=e.querySelector(a.content),s=t?n:e;e.dataset.animating=!0,t?n.style.height=parseInt(e.dataset.openedHeight)-parseInt(e.dataset.closedHeight)+"px":e.style.height=e.dataset.openedHeight,requestAnimationFrame(function(){t?n.style.height=0:e.style.height=e.dataset.closedHeight}),setTimeout(function(){e.dataset.animating=!1,e.classList.remove(a.openClass),e.querySelector(a.trigger).setAttribute("title",a.tooltipClosed)},a.cssTransitionSpeed)}(s),a.enableARIA&&(t.setAttribute("aria-expanded",!1),s.querySelector(a.content).setAttribute("aria-hidden",!0)),a.callbackClosed&&AU.handleCallback(a.callbackClosed,[t],t),a.bookmarkable&&(location.hash="#"),i&&a.remember&&(o=o.replace(t.getAttribute("href")+";",""))):(void 0===t.dataset.ajax||t.classList.contains("ajax_loaded")?d(s):(function(e,t){var n=new XMLHttpRequest;t.classList.add("loading"),n.onreadystatechange=function(s){if(4==this.readyState)if(200==this.status){if(t.classList.toggle("loading"),e.classList.add("ajax_loaded"),"html"==a.ajaxType&&!a.ajaxCustomHandling){for(var l=t.querySelector(a.content);l.firstChild;)l.removeChild(l.firstChild);l.innerHTML=n.response,c(t),d(t)}a.ajaxCallback&&AU.handleCallback(a.ajaxCallback,[n.response,!1],e)}else a.ajaxCallback&&AU.handleCallback(a.ajaxCallback,[!1,s],e)},n.open("GET",e.dataset.ajax,!0),n.send()}(t,s),a.ajaxCustomHandling&&d(s)),a.enableARIA&&(t.setAttribute("aria-expanded",!0),s.querySelector(a.content).setAttribute("aria-hidden",!1)),a.bookmarkable&&function(e){var t=e.getAttribute("id");e.removeAttribute("id"),location.hash=t,e.setAttribute("id",t)}(t),a.callbackOpened&&AU.handleCallback(a.callbackOpened,[t],t),i&&a.remember&&-1==o.indexOf(t.getAttribute("href")+";")&&(o=o+t.getAttribute("href")+";")),i&&localStorage.setItem("astralExpandables",o),e.preventDefault()}),t.forEach(e=>{e.classList.add("astral-expandable"),e.dataset.astralExpandablesTrigger=a.event,e.setAttribute("title",a.tooltipClosed)}),r)for(var p=0;p<r.length;p++)r[p].querySelector(a.trigger).setAttribute("title",a.tooltipOpened);a.enableARIA&&n.querySelectorAll(a.expandable).forEach(e=>{var t=e.classList.contains(a.openClass),n="expandable-"+Math.floor(9999999*Math.random());AU.setAttributes(e.querySelector(a.content),{role:"region","aria-labeledby":n,"aria-hidden":!t}),AU.setAttributes(e.querySelector(a.trigger),{role:"button","aria-controls":n,"aria-expanded":!!t})}),a.dropdown&&n.classList.add("dropdown"),s||((e=window.location.hash)&&e.length>1&&setTimeout(function(){var t=document.getElementById(e.substring(1));t.classList.contains("astral-expandable")&&t.dispatchEvent(new Event(a.event,{bubbles:!0}))},200),s=!0,setTimeout(function(){!function(){if("localStorage"in window&&null!==window.localStorage&&(o=localStorage.getItem("astralExpandables")?localStorage.getItem("astralExpandables"):"",i=!0,o.length>0))for(var e=o.split(";").filter(Boolean),t=0;t<e.length;t++){var a=document.getElementById(e[t].substring(1));a&&a.classList.contains("astral-expandable")&&a.dispatchEvent(new Event(a.dataset.astralExpandablesTrigger,{bubbles:!0}))}}()},200))}()}(e,t),{getConfig:function(){return a},recalculateDimensions:function(e){c(e)}}},n=[],s=document.querySelectorAll(e);return s?(s.forEach(function(e){n.push(new a(e,t))}),n):"invalid selector"};